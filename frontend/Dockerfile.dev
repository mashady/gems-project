FROM node:20

WORKDIR /app

# Copy package files
COPY frontend/package*.json ./

# Remove pnpm-lock.yaml if it exists to avoid conflicts
RUN rm -f pnpm-lock.yaml || true

# Install dependencies
RUN npm install --legacy-peer-deps || npm install

# Copy source files (excluding node_modules via .dockerignore)
COPY frontend/src ./src
COPY frontend/public ./public
COPY frontend/index.html ./
COPY frontend/vite.config.js ./
COPY frontend/vitest.config.js* ./
COPY frontend/eslint.config.js* ./

EXPOSE 5173

CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"]

